<%- include("./layouts/header.ejs") %>
<section class="hero">
  <img src="/assets/hero.webp" alt="" />
</section>

<section class="categories section-card">
  <div class="title">
    <div class="color-box"></div>
    <p class="title-name">Browse By Category</p>
  </div>
  <ul>
    <li>
      <a href="/categorySearch?category=mobile">
        <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#e8eaed"
      >
        <path
          d="M280-40q-33 0-56.5-23.5T200-120v-720q0-33 23.5-56.5T280-920h400q33 0 56.5 23.5T760-840v720q0 33-23.5 56.5T680-40H280Zm0-200v120h400v-120H280Zm200 100q17 0 28.5-11.5T520-180q0-17-11.5-28.5T480-220q-17 0-28.5 11.5T440-180q0 17 11.5 28.5T480-140ZM280-320h400v-400H280v400Zm0-480h400v-40H280v40Zm0 560v120-120Zm0-560v-40 40Z"
        />
      </svg>
      <p class="small-text">Phone</p>
      </a>
    </li>
    <li>
      <a href="/categorySearch?category=laptop">
        <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#e8eaed"
      >
        <path
          d="M80-160q-33 0-56.5-23.5T0-240h160q-33 0-56.5-23.5T80-320v-440q0-33 23.5-56.5T160-840h640q33 0 56.5 23.5T880-760v440q0 33-23.5 56.5T800-240h160q0 33-23.5 56.5T880-160H80Zm400-40q17 0 28.5-11.5T520-240q0-17-11.5-28.5T480-280q-17 0-28.5 11.5T440-240q0 17 11.5 28.5T480-200ZM160-320h640v-440H160v440Zm0 0v-440 440Z"
        />
      </svg>
      <p class="small-text">Laptop</p>
      </a>
    </li>
    <li>
      <a href="/categorySearch?category=watch">
        <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#e8eaed"
      >
        <path
          d="M360-500v-60h240v60H360Zm40 120v-60h160v60H400Zm20-420h120-120Zm0 640h120-120Zm-60 80-54-182q-48-38-77-95t-29-123q0-66 29-123t77-95l54-182h240l54 182q48 38 77 95t29 123q0 66-29 123t-77 95L600-80H360Zm120-200q83 0 141.5-58.5T680-480q0-83-58.5-141.5T480-680q-83 0-141.5 58.5T280-480q0 83 58.5 141.5T480-280Zm-76-470q20-5 38.5-8t37.5-3q19 0 37.5 3t38.5 8l-16-50H420l-16 50Zm16 590h120l16-50q-20 5-38.5 7.5T480-200q-19 0-37.5-2.5T404-210l16 50Z"
        />
      </svg>
      <p class="small-text">Watches</p>
      </a>
    </li>
    <li>
      <a href="/categorySearch?category=headphone">
        <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#e8eaed"
      >
        <path
          d="M360-120H200q-33 0-56.5-23.5T120-200v-280q0-75 28.5-140.5t77-114q48.5-48.5 114-77T480-840q75 0 140.5 28.5t114 77q48.5 48.5 77 114T840-480v280q0 33-23.5 56.5T760-120H600v-320h160v-40q0-117-81.5-198.5T480-760q-117 0-198.5 81.5T200-480v40h160v320Zm-80-240h-80v160h80v-160Zm400 0v160h80v-160h-80Zm-400 0h-80 80Zm400 0h80-80Z"
        />
      </svg>
      <p class="small-text">Headpones</p>
      </a>
    </li>
    <li>
     <a href="/categorySearch?category=camera">
      <svg
      xmlns="http://www.w3.org/2000/svg"
      height="24px"
      viewBox="0 -960 960 960"
      width="24px"
      fill="#e8eaed"
    >
      <path
        d="M480-260q75 0 127.5-52.5T660-440q0-75-52.5-127.5T480-620q-75 0-127.5 52.5T300-440q0 75 52.5 127.5T480-260Zm0-80q-42 0-71-29t-29-71q0-42 29-71t71-29q42 0 71 29t29 71q0 42-29 71t-71 29ZM160-120q-33 0-56.5-23.5T80-200v-480q0-33 23.5-56.5T160-760h126l74-80h240l74 80h126q33 0 56.5 23.5T880-680v480q0 33-23.5 56.5T800-120H160Zm0-80h640v-480H638l-73-80H395l-73 80H160v480Zm320-240Z"
      />
    </svg>
    <p class="small-text">Camera</p>
     </a>
    </li>
    <li>
      <a href="/categorySearch?category=gaming">
        <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#e8eaed"
      >
        <path
          d="M182-200q-51 0-79-35.5T82-322l42-300q9-60 53.5-99T282-760h396q60 0 104.5 39t53.5 99l42 300q7 51-21 86.5T778-200q-21 0-39-7.5T706-230l-90-90H344l-90 90q-15 15-33 22.5t-39 7.5Zm16-86 114-114h336l114 114q2 2 16 6 11 0 17.5-6.5T800-304l-44-308q-4-29-26-48.5T678-680H282q-30 0-52 19.5T204-612l-44 308q-2 11 4.5 17.5T182-280q2 0 16-6Zm482-154q17 0 28.5-11.5T720-480q0-17-11.5-28.5T680-520q-17 0-28.5 11.5T640-480q0 17 11.5 28.5T680-440Zm-80-120q17 0 28.5-11.5T640-600q0-17-11.5-28.5T600-640q-17 0-28.5 11.5T560-600q0 17 11.5 28.5T600-560ZM310-440h60v-70h70v-60h-70v-70h-60v70h-70v60h70v70Zm170-40Z"
        />
      </svg>
      <p class="small-text">Gaming</p>
      </a>
    </li>
  </ul>

</section>
<section class="grid-section section-card">
  <ul class="product-list-grid">
    
    <% categoriesedProducts.forEach(product => { %>
    <li class="product-card-grid">
      <a href="/user/product/<%= product._id %>"
        ><% if (product.images&& product.images.length>0) { %>
        <img src="<%= product.images[0] %>" alt="image" />
        <% } else { %>
        <img src="/assets/default-image.avif" alt="image" />
        <% } %>
      </a>
      <div class="fav-badge">
        <label class="fav-btn">
          <input
            type="checkbox"
            id="fav-check"
            data-product-id="<%= product._id %>"
            <% if (wishlistProductIds.includes(product._id.toString())) { %>checked<% } %>
          />
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
          >
            <path
              d="m480-120-58-52q-101-91-167-157T150-447.5Q111-500 95.5-544T80-634q0-94 63-157t157-63q52 0 99 22t81 62q34-40 81-62t99-22q94 0 157 63t63 157q0 46-15.5 90T810-447.5Q771-395 705-329T538-172l-58 52Z"
            />
          </svg>
        </label>
      </div>
      <div class="product-text">
        <p><%= product.name %></p>
        <div class="price-card">
          <p class="off-price">
             ₹<%= (product.price - (product.price * (product.offer / 100))).toFixed(0) %>
          </p>
          <p class="og-price">₹<%= product.price %></p>
        </div>
        <p class="rating"><%= product.rating %></p>
      </div>
    </li>
    <% }) %>
  </ul>
</section>

<section class="flash-sale section-card">
  <div class="title">
    <div class="color-box"></div>
    <p class="title-name">Flash Sale</p>
  </div>
  <ul class="product-card-list">
    <% products.sort((a, b) => b.rating - a.rating) %>
    <% products.forEach(product => { %>

    <li class="product-card">
      <a href="/user/product/<%= product._id %>"
        ><% if (product.images&& product.images.length>0) { %>
        <img src="<%= product.images[0] %>" alt="image" />
        <% } else { %>
        <img src="/assets/default-image.avif" alt="image" />
        <% } %></a
      >
      <div class="fav-badge">
        <label class="fav-btn">
          <input
            type="checkbox"
            id="fav-check"
            data-product-id="<%= product._id %>"
            <% if (wishlistProductIds.includes(product._id.toString())) { %>checked<% } %>
          />
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
          >
            <path
              d="m480-120-58-52q-101-91-167-157T150-447.5Q111-500 95.5-544T80-634q0-94 63-157t157-63q52 0 99 22t81 62q34-40 81-62t99-22q94 0 157 63t63 157q0 46-15.5 90T810-447.5Q771-395 705-329T538-172l-58 52Z"
            />
          </svg>
        </label>
      </div>
      <div class="product-text">
        <p><%= product.name %></p>
        <div class="price-card">
          <p class="off-price">
             ₹<%= (product.price - (product.price * (product.offer / 100))).toFixed(0) %>
          </p>
          <p class="og-price">₹<%= product.price %></p>
        </div>
        <p class="rating"><%= product.rating %></p>
      </div>
    </li>

    <% }) %>
  </ul>
</section>

<section class="hero">
  <img src="/assets/hero2.webp" alt="" />
</section>

<section class="best-selling section-card">
  <div class="title">
    <div class="color-box"></div>
    <p class="title-name">Best Selling Products</p>
  </div>
  <!-- Sorting products in decreasing order of their offer -->
  <% products.sort((a, b) => b.offer - a.offer) %>
  <ul class="product-card-list">
    <% products.forEach(product => { %>
    <li class="product-card">
      <a href="/user/product/<%= product._id %>">
        <% if (product.images && product.images.length > 0) { %>
        <img src="<%= product.images[0] %>" alt="image" /> <% } else { %>
        <img src="/assets/default-image.avif" alt="image" /> <% } %>
      </a>
      <div class="fav-badge">
        <label class="fav-btn">
          <input
            type="checkbox"
            id="fav-check"
            data-product-id="<%= product._id %>"
            <% if (wishlistProductIds.includes(product._id.toString())) { %>checked<% } %>
          />
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
          >
            <path
              d="m480-120-58-52q-101-91-167-157T150-447.5Q111-500 95.5-544T80-634q0-94 63-157t157-63q52 0 99 22t81 62q34-40 81-62t99-22q94 0 157 63t63 157q0 46-15.5 90T810-447.5Q771-395 705-329T538-172l-58 52Z"
            />
          </svg>
        </label>
      </div>
      <div class="product-text">
        <p><%= product.name %></p>
        <div class="price-card">
          <p class="off-price">
            ₹<%= (product.price - (product.price * (product.offer / 100))).toFixed(0) %>

          </p>
          <p class="og-price">₹<%= product.price %></p>
        </div>
        <p class="rating"><%= product.rating %></p>
      </div>
    </li>
    <% }) %>
  </ul>
</section>
<section class="grid-section section-card">
  <div class="title">
    <div class="color-box"></div>
    <p class="title-name">Explore Our Product</p>
  </div>
  <ul class="product-list-grid">
    
    <% products.forEach(product => { %>
    <li class="product-card-grid">
      <a href="/user/product/<%= product._id %>"
        ><% if (product.images&& product.images.length>0) { %>
        <img src="<%= product.images[0] %>" alt="image" />
        <% } else { %>
        <img src="/assets/default-image.avif" alt="image" />
        <% } %>
      </a>
      <div class="fav-badge">
        <label class="fav-btn">
          <input
            type="checkbox"
            id="fav-check"
            data-product-id="<%= product._id %>"
            <% if (wishlistProductIds.includes(product._id.toString())) { %>checked<% } %>
          />
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
          >
            <path
              d="m480-120-58-52q-101-91-167-157T150-447.5Q111-500 95.5-544T80-634q0-94 63-157t157-63q52 0 99 22t81 62q34-40 81-62t99-22q94 0 157 63t63 157q0 46-15.5 90T810-447.5Q771-395 705-329T538-172l-58 52Z"
            />
          </svg>
        </label>
      </div>
      <div class="product-text">
        <p><%= product.name %></p>
        <div class="price-card">
          <p class="off-price">
             ₹<%= (product.price - (product.price * (product.offer / 100))).toFixed(0) %>
          </p>
          <p class="og-price">₹<%= product.price %></p>
        </div>
        <p class="rating"><%= product.rating %></p>
      </div>
    </li>
    <% }) %>
  </ul>
</section>

<script>
  document.querySelectorAll("#fav-check").forEach(checkbox => {
    checkbox.addEventListener("change", function () {
      const productId = this.getAttribute("data-product-id");
      const isChecked = this.checked;
      fetch("/user/editWishlist", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ productId: productId, isChecked: isChecked }),
      })
        .then((response) => response.json())
        .then((data) => {
          console.log("Success:", data);
          window.location.reload();
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    });
  });

  
</script>


<%- include("./layouts/footer.ejs") %>
